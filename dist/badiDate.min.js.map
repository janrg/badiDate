{"version":3,"file":"badiDate.min.js","sources":["../src/locale/en.ts","../src/badiLocale.ts","../src/formatter.ts","../src/badiYears.ts","../src/badiDate.ts"],"sourcesContent":["const month = {\n    1: 'Bahá',\n    2: 'Jalál',\n    3: 'Jamál',\n    4: '‘Aẓamat',\n    5: 'Núr',\n    6: 'Raḥmat',\n    7: 'Kalimát',\n    8: 'Kamál',\n    9: 'Asmá’',\n    10: '‘Izzat',\n    11: 'Ma_sh_íyyat',\n    12: '‘Ilm',\n    13: 'Qudrat',\n    14: 'Qawl',\n    15: 'Masá’il',\n    16: '_Sh_araf',\n    17: 'Sulṭán',\n    18: 'Mulk',\n    19: '‘Alá’',\n    20: 'Ayyám-i-Há',\n};\n\nconst monthL = {\n    1: 'Splendour',\n    2: 'Glory',\n    3: 'Beauty',\n    4: 'Grandeur',\n    5: 'Light',\n    6: 'Mercy',\n    7: 'Words',\n    8: 'Perfection',\n    9: 'Names',\n    10: 'Might',\n    11: 'Will',\n    12: 'Knowledge',\n    13: 'Power',\n    14: 'Speech',\n    15: 'Questions',\n    16: 'Honour',\n    17: 'Sovereignty',\n    18: 'Dominion',\n    19: 'Loftiness',\n    20: 'Ayyám-i-Há',\n};\n\nconst holyDay = {\n    1: 'Naw-Rúz',\n    2: 'First day of Riḍván',\n    3: 'Ninth day of Riḍván',\n    4: 'Twelfth day of Riḍván',\n    5: 'Declaration of the Báb',\n    6: 'Ascension of Bahá’u’lláh',\n    7: 'Martyrdom of the Báb',\n    8: 'Birth of the Báb',\n    9: 'Birth of Bahá’u’lláh',\n    10: 'Day of the Covenant',\n    11: 'Ascension of ‘Abdu’l-Bahá',\n};\n\n// CAREFUL: Numbering corresponds to Badí' week, i.e. 1 is Jalál (-> Saturday)\nconst weekday = {\n    1: 'Jalál',\n    2: 'Jamál',\n    3: 'Kamál',\n    4: 'Fiḍál',\n    5: '‘Idál',\n    6: 'Istijlál',\n    7: 'Istiqlál',\n};\n\nconst weekdayAbbr3 = {\n    1: 'Jal',\n    2: 'Jam',\n    3: 'Kam',\n    4: 'Fiḍ',\n    5: '‘Idá',\n    6: 'Isj',\n    7: 'Isq',\n};\n\nconst weekdayAbbr2 = {\n    1: 'Jl',\n    2: 'Jm',\n    3: 'Ka',\n    4: 'Fi',\n    5: '‘Id',\n    6: 'Ij',\n    7: 'Iq',\n};\n\nconst weekdayL = {\n    1: 'Glory',\n    2: 'Beauty',\n    3: 'Perfection',\n    4: 'Grace',\n    5: 'Justice',\n    6: 'Majesty',\n    7: 'Independence',\n};\n\nconst yearInVahid = {\n    1: 'Alif',\n    2: 'Bá’',\n    3: 'Ab',\n    4: 'Dál',\n    5: 'Báb',\n    6: 'Váv',\n    7: 'Abad',\n    8: 'Jád',\n    9: 'Bahá',\n    10: 'Ḥubb',\n    11: 'Bahháj',\n    12: 'Javáb',\n    13: 'Aḥad',\n    14: 'Vahháb',\n    15: 'Vidád',\n    16: 'Badí‘',\n    17: 'Bahí',\n    18: 'Abhá',\n    19: 'Váḥid',\n};\n\nconst vahid = 'Váḥid';\nconst kulliShay = 'Kull-i-_Sh_ay’';\nconst BE = 'B.E.';\nconst badiCalendar = 'Badí‘ Calendar';\nconst unicodeCharForZero = '0';\nconst defaultFormat = 'd MM+ y BE';\n\nexport { month, monthL, holyDay, weekday, weekdayAbbr3, weekdayAbbr2, weekdayL, yearInVahid, vahid, kulliShay, BE,\n    badiCalendar, unicodeCharForZero, defaultFormat };\n","/* eslint-disable dot-notation, line-comment-position, camelcase, sort-imports */\nimport * as en from './locale/en';\nimport * as ar from './locale/ar';\nimport * as de from './locale/de';\nimport * as es from './locale/es';\nimport * as fa from './locale/fa';\nimport * as fr from './locale/fr';\nimport * as lv from './locale/lv';\nimport * as nl from './locale/nl';\nimport * as pt from './locale/pt';\nimport * as ru from './locale/ru';\nimport * as sv from './locale/sv';\nimport * as zh from './locale/zh';\nimport * as en_us from './locale/en-us';\nimport { UnderlineFormat } from './types';\n\nconst badiLocale = { en, ar, de, es, fa, fr, lv, nl, pt, ru, sv, zh, 'en-us': en_us, default: en };\n\nconst setDefaultLanguage = (language: string) => {\n    if (badiLocale[language] === undefined) {\n        // eslint-disable-next-line no-console\n        console.log('Chosen language does not exist. Setting has not been changed.');\n    } else {\n        badiLocale['default'] = badiLocale[language];\n    }\n};\n\nlet underlineFormat = 'css';\n\nconst setUnderlineFormat = (format: UnderlineFormat) => {\n    if (['css', 'u', 'diacritic', 'none'].includes(format)) {\n        underlineFormat = format;\n    } else {\n        // eslint-disable-next-line no-console\n        console.log('Invalid underline format. Choose one of [\"css\", \"u\", \"diacritic\", \"none\"]. ' +\n            'Setting has not been changed.');\n    }\n};\n\nexport { badiLocale, setDefaultLanguage, setUnderlineFormat, underlineFormat };\n","import { badiLocale, underlineFormat } from './badiLocale';\nimport { BadiDate } from './badiDate';\n\nconst formatTokens: Array<Array<string>> = [\n    ['DDL', 'DD+', 'MML', 'MM+', 'WWL', 'yyv', 'KiS'],\n    ['dd', 'DD', 'mm', 'MM', 'ww', 'WW', 'yv', 'YV', 'vv', 'kk', 'yy', 'BE', 'BC', 'Va'],\n    ['d', 'D', 'm', 'M', 'W', 'v', 'k', 'y']];\n\n// eslint-disable-next-line complexity\nconst formatBadiDate = (badiDate: BadiDate, formatString?: string, language?: string): string => {\n    if (!badiDate.isValid) {\n        return 'Not a valid Badí‘ date';\n    }\n    if (typeof language === 'string' && badiLocale[language] === undefined && language.includes('-')) {\n        language = language.split('-')[0];\n    }\n    if (language === undefined || badiLocale[language] === undefined) {\n        language = 'default';\n    }\n    formatString = formatString ?? formatItemFallback(language, 'defaultFormat');\n    let formattedDate = '';\n    const length = formatString.length;\n    for (let i = 0; i < length; i++) {\n        // Text wrapped in {} is output as-is. A '{' without a matching '}'\n        // results in invalid input\n        if (formatString[i] === '{' && i < length - 1) {\n            for (let j = i + 1; j <= length; j++) {\n                if (j === length) {\n                    return 'Invalid formatting string.';\n                }\n                if (formatString[j] === '}') {\n                    i = j;\n                    break;\n                }\n                formattedDate += formatString[j];\n            }\n        } else {\n            const next1 = formatString[i];\n            const next2 = next1 + formatString[i + 1];\n            const next3 = next2 + formatString[i + 2];\n            if (formatTokens[0].includes(next3)) {\n                formattedDate += getFormatItem(badiDate, next3, language);\n                i += 2;\n            } else if (formatTokens[1].includes(next2)) {\n                formattedDate += getFormatItem(badiDate, next2, language);\n                i += 1;\n            } else if (formatTokens[2].includes(next1)) {\n                formattedDate += getFormatItem(badiDate, next1, language);\n            } else {\n                formattedDate += next1;\n            }\n        }\n    }\n    return formattedDate;\n};\n\n// eslint-disable-next-line complexity\nconst getFormatItem = (badiDate: BadiDate, token: string, language: string): string => {\n    switch (token) {\n        // Single character tokens\n        case 'd':\n            return digitRewrite(badiDate.day, language);\n        case 'D':\n            return postProcessLocaleItem(formatItemFallback(language, 'month', badiDate.day), 3);\n        case 'm':\n            return digitRewrite(badiDate.month, language);\n        case 'M':\n            return postProcessLocaleItem(formatItemFallback(language, 'month', badiDate.month), 3);\n        case 'W':\n            return formatItemFallback(language, 'weekdayAbbr3', (badiDate.gregorianDate.weekday + 1) % 7 + 1);\n        case 'y':\n            return digitRewrite(badiDate.year, language);\n        case 'v':\n            return digitRewrite((Math.floor((badiDate.year - 1) / 19) % 19) + 1, language);\n        case 'k':\n            return digitRewrite(Math.floor((badiDate.year - 1) / 361) + 1, language);\n        // Two character tokens\n        case 'dd':\n            return digitRewrite((`0${String(badiDate.day)}`).slice(-2), language);\n        case 'DD':\n            return postProcessLocaleItem(formatItemFallback(language, 'month', badiDate.day));\n        case 'mm':\n            return digitRewrite((`0${String(badiDate.month)}`).slice(-2), language);\n        case 'MM':\n            return postProcessLocaleItem(formatItemFallback(language, 'month', badiDate.month));\n        case 'ww':\n            return formatItemFallback(language, 'weekdayAbbr2', (badiDate.gregorianDate.weekday + 1) % 7 + 1);\n        case 'WW':\n            return formatItemFallback(language, 'weekday', (badiDate.gregorianDate.weekday + 1) % 7 + 1);\n        case 'yy':\n            return digitRewrite((`00${String(badiDate.year)}`).slice(-3), language);\n        case 'yv':\n            return digitRewrite((badiDate.year - 1) % 19 + 1, language);\n        case 'YV':\n            return formatItemFallback(language, 'yearInVahid', (badiDate.year - 1) % 19 + 1);\n        case 'vv':\n            return digitRewrite(\n                (`0${String((Math.floor((badiDate.year - 1) / 19) + 2) % 19 - 1)}`).slice(-2), language);\n        case 'kk':\n            return digitRewrite((`0${String(Math.floor((badiDate.year - 1) / 361) + 1)}`).slice(-2), language);\n        case 'Va':\n            return formatItemFallback(language, 'vahid');\n        case 'BE':\n            return formatItemFallback(language, 'BE');\n        case 'BC':\n            return formatItemFallback(language, 'badiCalendar');\n        // Three character tokens\n        case 'DDL':\n            return formatItemFallback(language, 'monthL', badiDate.day);\n        case 'DD+': {\n            const day = postProcessLocaleItem(formatItemFallback(language, 'month', badiDate.day));\n            const dayL = formatItemFallback(language, 'monthL', badiDate.day);\n            if (day === dayL) {\n                return day;\n            }\n            if (badiLocale[language] === badiLocale.fa) {\n                return `<span dir=\"rtl\">${day} (${dayL})</span>`;\n            }\n            return `${day} (${dayL})`;\n        }\n        case 'MML':\n            return formatItemFallback(language, 'monthL', badiDate.month);\n        case 'MM+': {\n            const month = postProcessLocaleItem(formatItemFallback(language, 'month', badiDate.month));\n            const monthL = formatItemFallback(language, 'monthL', badiDate.month);\n            if (month === monthL) {\n                return month;\n            }\n            if (badiLocale[language] === badiLocale.fa) {\n                return `<span dir=\"rtl\">${month} (${monthL})</span>`;\n            }\n            return `${month} (${monthL})`;\n        }\n        case 'WWL':\n            return formatItemFallback(language, 'weekdayL', (badiDate.gregorianDate.weekday + 1) % 7 + 1);\n        case 'yyv':\n            return digitRewrite((`0${String((badiDate.year - 1) % 19 + 1)}`).slice(-2), language);\n        case 'KiS':\n            return postProcessLocaleItem(formatItemFallback(language, 'kulliShay'));\n        // istanbul ignore next\n        default:\n            return '';\n    }\n};\n\nconst postProcessLocaleItem = (item: string, crop?: number): string => {\n    if (crop && crop < item.length) {\n        let char = 0;\n        let counter = 0;\n        while (counter < crop) {\n            if (!'_’‘'.includes(item[char])) {\n                counter++;\n            }\n            char++;\n        }\n        if ('_’‘'.includes(item[char])) {\n            char++;\n        }\n        item = item.slice(0, char);\n        if (item.split('_').length % 2 === 0) {\n            item += '_';\n        }\n    }\n    const stringComponents = item.split('_');\n    for (let i = 1; i < stringComponents.length; i += 2) {\n        stringComponents[i] = underlineString(stringComponents[i]);\n    }\n    return stringComponents.join('');\n};\n\nconst underlineString = (str: string): string => {\n    switch (underlineFormat) {\n        case 'css':\n            return `<span style=\"text-decoration:underline\">${str}</span>`;\n        case 'diacritic':\n            return str.split('').map(char => `${char}\\u0332`).join('');\n        case 'u':\n            return `<u>${str}</u>`;\n        case 'none':\n            return str;\n        // istanbul ignore next\n        default:\n            throw new TypeError('Unexpected underlineFormat');\n    }\n};\n\nconst digitRewrite = (number: number | string, language: string): string => {\n    number = String(number);\n    const unicodeOffset = formatItemFallback(language, 'unicodeCharForZero').charCodeAt(0) - '0'.charCodeAt(0);\n    if (unicodeOffset === 0) {\n        return number;\n    }\n    const codePoints = [...number].map(num => num.charCodeAt(0) + unicodeOffset);\n    return String.fromCharCode(...codePoints);\n};\n\nconst formatItemFallback = (language: string, category: string, index?: number): string => {\n    if (index === undefined) {\n        while (badiLocale[language][category] === undefined) {\n            language = languageFallback(language);\n        }\n        return badiLocale[language][category];\n    }\n    while (badiLocale[language][category]?.[index] === undefined) {\n        language = languageFallback(language);\n    }\n    return badiLocale[language][category][index];\n};\n\nconst languageFallback = (languageCode: string): string => {\n    if (languageCode.includes('-')) {\n        return languageCode.split('-')[0];\n        // eslint-disable-next-line no-negated-condition\n    } else if (languageCode !== 'default') {\n        return 'default';\n    }\n    return 'en';\n};\n\nexport { formatBadiDate, formatItemFallback };\n","const badiYears = [\n    'l4da', 'k4ci', 'k5c7', 'l4d6', 'l4ce', 'k4c4', 'k5d4', 'l4cb', 'l4c1', 'k4cj', 'k5c8', 'l4d7', 'l4cf', 'k4c5',\n    'k4d5', 'k5ce', 'l4c2', 'k4d2', 'k4ca', 'k5da', 'l4ch', 'k4c6', 'k4d6', 'k5cf', 'l4c4', 'k4d4', 'k4cc', 'k5c1',\n    'l4cj', 'k4c8', 'k4d8', 'k5cg', 'l4c5', 'k4d5', 'k4ce', 'k5c3', 'l4d2', 'k4ca', 'k4d9', 'k5ci', 'l4c6', 'k4d6',\n    'k4cf', 'k4c4', 'k5d4', 'k4cb', 'k4bj', 'k4cj', 'k5c9', 'k4d8', 'k4cg', 'k4c6', 'k5d6', 'k4cd', 'k4c2', 'k4d2',\n    'k5ca', 'k4d9', 'k4ci', 'k4c7', 'k5d7', 'k4cf', 'k4c4', 'k4d4', 'k5cc', 'k4bj', 'k4cj', 'k4c9', 'k5d9', 'k4cg',\n    'k4c6', 'k4d5', 'k5cd', 'k4c2', 'k4d1', 'k4ca', 'k4da', 'j5cj', 'k4c7', 'k4d7', 'k4cf', 'j5c4', 'k4d3', 'k4cb',\n    'k4c1', 'k5d1', 'l4c9', 'l4d9', 'l4ch', 'k5c6', 'l4d5', 'l4cd', 'l4c2', 'k5d2', 'l4ca', 'l4da', 'l4cj', 'k5c8',\n    'l4d7', 'l4cf', 'l4c4', 'k5d4', 'l4cb', 'l4c1', 'l4d1', 'k5c9', 'l4d8', 'l4cg', 'l4c5', 'k4d5', 'k5ce', 'l4c2',\n    'l4d2', 'k4cb', 'k5db', 'l4ci', 'l4c7', 'k4d7', 'k5cf', 'l4c4', 'l4d4', 'k4cc', 'k5c2', 'l4d1', 'l4c9', 'k4d9',\n    'k5ch', 'l4c5', 'l4d5', 'k4ce', 'k5c3', 'l4d2', 'l4cb', 'k4da', 'k5ci', 'l4c6', 'l4d6', 'k4cf', 'k5c5', 'l4d4',\n    'l4cc', 'k4c1', 'k4d1', 'k5c9', 'l4d8', 'k4cg', 'k4c6', 'k5d6', 'l4ce', 'k4c3', 'k4d3', 'k5cb', 'l4da', 'k4ci',\n    'k4c7', 'k5d7', 'l4cf', 'k4c5', 'k4d5', 'k5cd', 'l4c1', 'k4cj', 'k4c9', 'k5d9', 'l4cg', 'k4c6', 'k4d6', 'k5ce',\n    'l4c3', 'k4d2', 'k4ca', 'k5bj', 'l4ci', 'k4c7', 'k4d7', 'k4cg', 'k5c5', 'k4d4', 'k4cc', 'k4c1', 'k5d1', 'k4c9',\n    'k4d9', 'k4ch', 'k5c7', 'l4d6', 'l4ce', 'l4c3', 'l5d3', 'l4ca', 'l4da', 'l4cj', 'l5c8', 'l4d7', 'l4cg', 'l4c5',\n    'l5d4', 'l4cb', 'l4c1', 'l4d1', 'l5ca', 'l4d9', 'l4ch', 'l4c6', 'l5d6', 'l4cd', 'l4c2', 'l4d2', 'l4cb', 'k5c1',\n    'l4cj', 'l4c8', 'l4d8', 'k5cg', 'l4c4', 'l4d4', 'l4cc', 'k5c2', 'l4d1', 'l4ca', 'l4da', 'k5ci', 'l4c6', 'l4d5',\n    'l4ce', 'k5c3', 'l4d2', 'l4cb', 'l4db', 'k5cj', 'l4c8', 'l4d7', 'l4cf', 'k5c5', 'l4d4', 'l4cc', 'l4c2', 'k5d2',\n    'l4c9', 'l4d9', 'l4ch', 'k4c6', 'k5d6', 'l4ce', 'l4c3', 'k4d3', 'k5cc', 'l4db', 'l4cj', 'k4c8', 'k5d8', 'l4cf',\n    'l4c4', 'k4d5', 'k5cd', 'l4c2', 'l4d2', 'k4ca', 'k5d9', 'l4cg', 'l4c6', 'k4d6', 'k5cf', 'l4c3', 'l4d3', 'k4cb',\n    'k5bj', 'l4ci', 'l4c7', 'k4d7', 'k5cg', 'l4c5', 'l4d5', 'k4cd', 'k4c2', 'k5d2', 'l4c9', 'k4d9', 'k4ch', 'k5c7',\n    'l4d6', 'k4cf', 'k4c4', 'k5d4', 'l4cb', 'l4bj', 'l4cj', 'l5c8', 'm4d7', 'l4cg', 'l4c5', 'l5d5', 'm4cc', 'l4c1',\n    'l4d1', 'l5ca', 'm4d9', 'l4ch', 'l4c7', 'l5d7', 'm4ce', 'l4c3', 'l4d3', 'l5cb', 'm4bi', 'l4ci', 'l4c8', 'l4d8',\n    'l5ch', 'l4c5', 'l4d5', 'l4cd', 'l5c2', 'l4d1', 'l4c9', 'l4da', 'l5ci', 'l4c7', 'l4d7', 'l4cf', 'l5c4', 'l4d2',\n    'l4cb', 'l4bj', 'l5d1', 'l4c8', 'l4d8', 'l4cg', 'l5c5', 'l4d4', 'l4cc', 'l4c2', 'l5d2', 'l4c9', 'l4da', 'l4ci',\n];\n\nexport { badiYears };\n","import * as luxon from 'luxon';\nimport { badiLocale, setDefaultLanguage, setUnderlineFormat } from './badiLocale';\nimport { formatBadiDate, formatItemFallback } from './formatter';\nimport { BadiDateSettings, BadiYearInfo, HolyDay, InputDate, YearHolyDayNumber, YearMonthDay } from './types';\nimport { badiYears } from './badiYears';\n\nclass BadiDate {\n    private _gregorianDate: luxon.DateTime;\n    private _year: number;\n    private _month: number;\n    private _day: number;\n    private _nawRuz: luxon.DateTime;\n    private _ayyamiHaLength: number;\n    private _yearTwinBirthdays: Array<number>;\n    private _holyDay?: HolyDay = undefined;\n    private _valid: boolean = true;\n    private _invalidReason: string = undefined;\n\n    constructor(date: InputDate) {\n        try {\n            if (this._isDateObject(date)) {\n                this._gregorianDate = luxon.DateTime.fromObject(\n                    { year: date.getFullYear(), month: date.getMonth() + 1, day: date.getDate(), zone: 'UTC' });\n            } else if (luxon.DateTime.isDateTime(date)) {\n                this._gregorianDate = luxon.DateTime.fromObject(\n                    { year: date.year, month: date.month, day: date.day, zone: 'UTC' });\n            } else if (this._isYearMonthDay(date) || this._isYearHolyDayNumber(date)) {\n                this._setFromBadiDate(date);\n            } else {\n                throw new TypeError('Unrecognized input format');\n            }\n            if (this._year === undefined) {\n                // We haven't set the Badí' date yet\n                this._setFromGregorianDate();\n            }\n            this._setHolyDay();\n        } catch (err) {\n            this._setInvalid(err);\n        }\n        Object.freeze(this);\n    }\n\n    format(formatString?: string, language?: string): string {\n        return formatBadiDate(this, formatString, language);\n    }\n\n    _isDateObject(arg: any): arg is Date {\n        return Object.prototype.toString.call(arg) === '[object Date]';\n    }\n\n    _isYearMonthDay(arg: any): arg is YearMonthDay {\n        return typeof arg.year === 'number' && typeof arg.month === 'number' &&\n            typeof arg.day === 'number';\n    }\n\n    _isYearHolyDayNumber(arg: any): arg is YearHolyDayNumber {\n        return typeof arg.year === 'number' && arg.month === undefined &&\n            arg.day === undefined && typeof arg.holyDayNumber === 'number';\n    }\n\n    _notInValidGregorianDateRange(datetime: luxon.DateTime): boolean {\n        const lowerBound = luxon.DateTime.fromObject({ year: 1844, month: 3, day: 21, zone: 'UTC' });\n        const upperBound = luxon.DateTime.fromObject({ year: 2351, month: 3, day: 20, zone: 'UTC' });\n        return datetime < lowerBound || datetime > upperBound;\n    }\n\n    _setFromGregorianDate() {\n        if (this._notInValidGregorianDateRange(this._gregorianDate)) {\n            throw new RangeError('Input date outside of valid range (1844-03-21 - 2351-03-20)');\n        }\n        const gregorianYear = this._gregorianDate.year;\n        const oldImplementationCutoff = luxon.DateTime.fromObject({ year: 2015, month: 3, day: 21, zone: 'UTC' });\n        if (this._gregorianDate < oldImplementationCutoff) {\n            const { month, day } = this._gregorianDate;\n            if (month < 3 || (month === 3 && day < 21)) {\n                this._nawRuz = luxon.DateTime.fromObject({ year: gregorianYear - 1, month: 3, day: 21, zone: 'UTC' });\n                this._year = gregorianYear - 1844;\n            } else {\n                this._nawRuz = luxon.DateTime.fromObject({ year: gregorianYear, month: 3, day: 21, zone: 'UTC' });\n                this._year = gregorianYear - 1843;\n            }\n            this._setOldAyyamiHaLength();\n            this._yearTwinBirthdays = [12, 5, 13, 9];\n        } else {\n            this._year = gregorianYear - 1843;\n            this._setBadiYearInfo(true);\n        }\n        this._setBadiMonthAndDay();\n    }\n\n    /**\n     * Set Badí' month and day from Gregorian date\n     */\n    _setBadiMonthAndDay() {\n        const dayOfBadiYear = this._dayOfYear(this._gregorianDate);\n        if (dayOfBadiYear < 343) {\n            this._month = Math.floor((dayOfBadiYear - 1) / 19 + 1);\n            this._day = (dayOfBadiYear - 1) % 19 + 1;\n        } else if (dayOfBadiYear < 343 + this._ayyamiHaLength) {\n            this._month = 20;\n            this._day = dayOfBadiYear - 342;\n        } else {\n            this._month = 19;\n            this._day = dayOfBadiYear - (342 + this._ayyamiHaLength);\n        }\n    }\n\n    _setFromBadiDate(date: YearMonthDay | YearHolyDayNumber) { // eslint-disable-line complexity\n        this._year = date.year;\n        if (this._year < 1 || this._year > 507) {\n            throw new RangeError('Input date outside of valid range (1 - 507 B.E.)');\n        } else if (this._year < 172) {\n            this._nawRuz = luxon.DateTime.fromObject({ year: 1843 + this._year, month: 3, day: 21, zone: 'UTC' });\n            this._setOldAyyamiHaLength();\n            this._yearTwinBirthdays = [12, 5, 13, 9];\n        } else {\n            this._setBadiYearInfo();\n        }\n        if (this._isYearMonthDay(date)) {\n            this._month = date.month;\n            this._day = date.day;\n            if (this._month === 20 && this._day > this._ayyamiHaLength) {\n                // If only off by one day, we'll bubble up so that 5th Ayyám-i-Há in a year with only 4 days of\n                // Ayyám-i-Há can be salvaged\n                if (this._day - this._ayyamiHaLength === 1) {\n                    this._month = 19;\n                    this._day = 1;\n                } else {\n                    throw new TypeError('Input numbers do not designate a valid date');\n                }\n            }\n            if (this._month < 1 || this._month > 20 || this._day < 1 || this.day > 19) {\n                throw new TypeError('Input numbers do not designate a valid date');\n            }\n        } else {\n            if (date.holyDayNumber < 1 || date.holyDayNumber > 11) {\n                throw new TypeError('Input numbers do not designate a valid Holy Day');\n            }\n            this._holyDay = date.holyDayNumber;\n            [this._month, this._day] = this._holyDayMapping()[this._holyDay];\n        }\n        this._gregorianDate = this._nawRuz.plus(luxon.Duration.fromObject(\n            { days: this._dayOfYear([this._year, this._month, this._day]) - 1 }));\n    }\n\n    _setOldAyyamiHaLength() {\n        if (luxon.DateTime.fromObject({ year: this._nawRuz.year + 1 }).isInLeapYear) {\n            this._ayyamiHaLength = 5;\n        } else {\n            this._ayyamiHaLength = 4;\n        }\n    }\n\n    _setBadiYearInfo(fromGregorianDate: boolean = false) {\n        let yearData = this._extractBadiYearInfo();\n        if (fromGregorianDate && this._gregorianDate < yearData.nawRuz) {\n            this._year -= 1;\n            yearData = this._extractBadiYearInfo();\n        }\n        this._nawRuz = yearData.nawRuz;\n        this._ayyamiHaLength = yearData.ayyamiHaLength;\n        this._yearTwinBirthdays = yearData.twinBirthdays;\n    }\n\n    _extractBadiYearInfo(): BadiYearInfo {\n        let nawRuz, ayyamiHaLength, twinBirthdays;\n        // Check whether data needs to be unpacked or exists in the verbose version\n        // istanbul ignore else\n        if (badiYears[0] === 'l4da') {\n            const components = badiYears[this._year - 172].split('');\n            nawRuz = luxon.DateTime.fromObject(\n                { year: this._year - 172 + 2015, month: 3, day: parseInt(components[0], 36), zone: 'UTC' });\n            ayyamiHaLength = parseInt(components[1], 36);\n            const TB1 = [parseInt(components[2], 36), parseInt(components[3], 36)];\n            const TB2 = TB1[1] < 19 ? [TB1[0], TB1[1] + 1] : [TB1[0] + 1, 1];\n            twinBirthdays = [TB1[0], TB1[1], TB2[0], TB2[1]];\n        } else {\n            ({ nawRuz, ayyamiHaLength, twinBirthdays } = badiYears[this._year] as any);\n            nawRuz = luxon.DateTime.fromISO(nawRuz, { zone: 'UTC' });\n        }\n        return { nawRuz, ayyamiHaLength, twinBirthdays };\n    }\n\n    _dayOfYear(date: Array<number> | luxon.DateTime): number {\n        // Naw-Rúz is day 1\n        if (Array.isArray(date)) {\n            // We have a Badí' date\n            if (date[1] < 19) {\n                return 19 * (date[1] - 1) + date[2];\n            } else if (date[1] === 20) {\n                return 342 + date[2];\n            }\n            // date[1] === 19\n            return 342 + this._ayyamiHaLength + date[2];\n        }\n        return (date as luxon.DateTime).diff(this._nawRuz).as('days') + 1;\n    }\n\n    _setInvalid(invalidReason: string) {\n        this._gregorianDate = luxon.DateTime.invalid('Not a valid Badí‘ date');\n        this._year = NaN;\n        this._month = NaN;\n        this._day = NaN;\n        this._ayyamiHaLength = NaN;\n        this._nawRuz = luxon.DateTime.invalid('Not a valid Badí‘ date');\n        this._valid = false;\n        this._invalidReason = invalidReason;\n    }\n\n    _setHolyDay() {\n        const mapping = this._holyDayMapping();\n        this._holyDay = parseInt(Object.keys(mapping)\n            .find(key => mapping[key][0] === this._month && mapping[key][1] === this._day), 10);\n    }\n\n    _holyDayMapping(): object {\n        return {\n            [HolyDay.NawRuz]: [1, 1],\n            [HolyDay.FirstRidvan]: [2, 13],\n            [HolyDay.NinthRidvan]: [3, 2],\n            [HolyDay.TwelfthRidvan]: [3, 5],\n            [HolyDay.DeclarationOfTheBab]: [4, this._year < 172 ? 7 : 8],\n            [HolyDay.AscensionOfBahaullah]: [4, 13],\n            [HolyDay.MartyrdomOfTheBab]: [6, this._year < 172 ? 16 : 17],\n            [HolyDay.BirthOfTheBab]: [this._yearTwinBirthdays[0], this._yearTwinBirthdays[1]],\n            [HolyDay.BirthOfBahaullah]: [this._yearTwinBirthdays[2], this._yearTwinBirthdays[3]],\n            [HolyDay.DayOfTheCovenant]: [14, 4],\n            [HolyDay.AscensionOfAbdulBaha]: [14, 6],\n        };\n    }\n\n    _leapYearsBefore(): number {\n        let leapYearsBefore = Math.floor(Math.min(this.year - 1, 171) / 4);\n        if (this.year > 172) {\n            // istanbul ignore else\n            if (badiYears[0] === 'l4da') {\n                leapYearsBefore += badiYears.slice(0, this.year - 172).filter(entry => entry[1] === '5').length;\n            } else {\n                leapYearsBefore += Object.entries(badiYears)\n                    .filter(([year, data]) => parseInt(year, 10) < this.year &&\n                        (data as any).ayyamiHaLength === 5).length;\n            }\n        }\n        return leapYearsBefore;\n    }\n\n    holyDay(language: string = undefined): string {\n        if (!this._holyDay) {\n            return '';\n        }\n        if (language === undefined || badiLocale[language] === undefined) {\n            language = 'default';\n        }\n        return formatItemFallback(language, 'holyDay', this._holyDay);\n    }\n\n    valueOf() {\n        return this._dayOfYear([this.year, this.month, this.day]) + this._leapYearsBefore() + (this.year - 1) * 365;\n    }\n\n    equals(other: BadiDate) {\n        return this.isValid && other.isValid && this.valueOf() === other.valueOf();\n    }\n\n    get isValid(): boolean {\n        return this._valid;\n    }\n\n    get invalidReason(): string | undefined {\n        return this._invalidReason;\n    }\n\n    get day(): number {\n        return this._day;\n    }\n\n    get month(): number {\n        return this._month;\n    }\n\n    get year(): number {\n        return this._year;\n    }\n\n    // number of the Badí' weekday between 1 (Jalál ~> Saturday) and 7 (Istiqlál ~> Friday).\n    get weekday(): number {\n        return (this._gregorianDate.weekday + 1) % 7 + 1;\n    }\n\n    get yearInVahid(): number {\n        return (this._year - 1) % 19 + 1;\n    }\n\n    get vahid(): number {\n        return (Math.floor((this._year - 1) / 19) % 19) + 1;\n    }\n\n    get kullIShay(): number {\n        return Math.floor((this._year - 1) / 361) + 1;\n    }\n\n    // Gregorian date on whose sunset the Badí' date ends.\n    get gregorianDate(): luxon.DateTime {\n        return this._gregorianDate;\n    }\n\n    get ayyamiHaLength(): number {\n        return this._ayyamiHaLength;\n    }\n\n    get holyDayNumber(): number | undefined {\n        return this._holyDay ? this._holyDay : undefined;\n    }\n\n    get workSuspended(): boolean | undefined {\n        return this._holyDay ? this.holyDayNumber < 10 : undefined;\n    }\n\n    get nextMonth(): BadiDate {\n        let { year, month } = this;\n        switch (month) {\n            case 18:\n                month = 20;\n                break;\n            case 19:\n                month = 1;\n                year += 1;\n                break;\n            case 20:\n                month = 19;\n                break;\n            default:\n                month += 1;\n        }\n        return new BadiDate({ year, month, day: 1 });\n    }\n\n    get previousMonth(): BadiDate {\n        let { year, month } = this;\n        switch (month) {\n            case 1:\n                month = 19;\n                year -= 1;\n                break;\n            case 19:\n                month = 20;\n                break;\n            case 20:\n                month = 18;\n                break;\n            default:\n                month -= 1;\n        }\n        return new BadiDate({ year, month, day: 1 });\n    }\n\n    get nextDay(): BadiDate {\n        if (this._day === 19 || (this._month === 20 && this._day === this._ayyamiHaLength)) {\n            return this.nextMonth;\n        }\n        return new BadiDate({ year: this._year, month: this._month, day: this._day + 1 });\n    }\n\n    get previousDay(): BadiDate {\n        if (this._day === 1) {\n            const { previousMonth } = this;\n            let day = 19;\n            if (this._month === 19) {\n                day = this._ayyamiHaLength;\n            }\n            return new BadiDate({\n                year: previousMonth.year,\n                month: previousMonth.month,\n                day,\n            });\n        }\n        return new BadiDate({ year: this._year, month: this._month, day: this._day - 1 });\n    }\n}\n\nconst badiDateSettings = (settings: BadiDateSettings) => {\n    if (settings.defaultLanguage) {\n        setDefaultLanguage(settings.defaultLanguage);\n    }\n    if (settings.underlineFormat) {\n        setUnderlineFormat(settings.underlineFormat);\n    }\n};\n\nexport { BadiDate, badiDateSettings };\n"],"names":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","badiLocale","en","default","underlineFormat","formatTokens","getFormatItem","badiDate","token","language","digitRewrite","day","postProcessLocaleItem","formatItemFallback","month","gregorianDate","weekday","year","Math","floor","String","slice","dayL","fa","monthL","item","crop","length","char","counter","includes","split","stringComponents","i","underlineString","join","str","map","TypeError","number","unicodeOffset","charCodeAt","codePoints","num","fromCharCode","category","index","undefined","languageFallback","languageCode","badiYears","BadiDate","[object Object]","date","this","_isDateObject","_gregorianDate","luxon.DateTime","fromObject","getFullYear","getMonth","getDate","zone","isDateTime","_isYearMonthDay","_isYearHolyDayNumber","_setFromBadiDate","_year","_setFromGregorianDate","_setHolyDay","err","_setInvalid","Object","freeze","formatString","isValid","formattedDate","j","next1","next2","next3","formatBadiDate","arg","prototype","toString","call","holyDayNumber","datetime","lowerBound","upperBound","_notInValidGregorianDateRange","RangeError","gregorianYear","oldImplementationCutoff","_nawRuz","_setOldAyyamiHaLength","_yearTwinBirthdays","_setBadiYearInfo","_setBadiMonthAndDay","dayOfBadiYear","_dayOfYear","_month","_day","_ayyamiHaLength","_holyDay","_holyDayMapping","plus","luxon.Duration","days","isInLeapYear","fromGregorianDate","yearData","_extractBadiYearInfo","nawRuz","ayyamiHaLength","twinBirthdays","components","parseInt","TB1","TB2","fromISO","Array","isArray","diff","as","invalidReason","invalid","NaN","_valid","_invalidReason","mapping","keys","find","key","leapYearsBefore","min","filter","entry","entries","data","_leapYearsBefore","other","valueOf","yearInVahid","vahid","kullIShay","workSuspended","nextMonth","previousMonth","nextDay","previousDay","settings","format","defaultLanguage","console","log"],"mappings":"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,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OACxG,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,OAAQ,QClB5G,MAAMC,EAYFC,YAAYC,GAJJC,mBAAqBP,EACrBO,aAAkB,EAClBA,yBAAyBP,EAG7B,IACI,GAAIO,KAAKC,cAAcF,GACnBC,KAAKE,eAAiBC,WAAeC,WACjC,CAAEzC,KAAMoC,EAAKM,cAAe7C,MAAOuC,EAAKO,WAAa,EAAGjD,IAAK0C,EAAKQ,UAAWC,KAAM,aACpF,GAAIL,WAAeM,WAAWV,GACjCC,KAAKE,eAAiBC,WAAeC,WACjC,CAAEzC,KAAMoC,EAAKpC,KAAMH,MAAOuC,EAAKvC,MAAOH,IAAK0C,EAAK1C,IAAKmD,KAAM,YAC5D,CAAA,IAAIR,KAAKU,gBAAgBX,KAASC,KAAKW,qBAAqBZ,GAG/D,MAAM,IAAIf,UAAU,6BAFpBgB,KAAKY,iBAAiBb,QAIPN,IAAfO,KAAKa,OAELb,KAAKc,wBAETd,KAAKe,cACP,MAAOC,GACLhB,KAAKiB,YAAYD,GAErBE,OAAOC,OAAOnB,MAGlBF,OAAOsB,EAAuBjE,GAC1B,MFlCe,EAACF,EAAoBmE,EAAuBjE,KAC/D,IAAKF,EAASoE,QACV,MAAO,yBAEa,iBAAblE,QAAkDsC,IAAzB9C,EAAWQ,IAA2BA,EAASqB,SAAS,OACxFrB,EAAWA,EAASsB,MAAM,KAAK,SAElBgB,IAAbtC,QAAmDsC,IAAzB9C,EAAWQ,KACrCA,EAAW,WAGf,IAAImE,EAAgB,GACpB,MAAMjD,GAFN+C,EAAeA,MAAAA,EAAAA,EAAgB7D,EAAmBJ,EAAU,kBAEhCkB,OAC5B,IAAK,IAAIM,EAAI,EAAGA,EAAIN,EAAQM,IAGxB,GAAwB,MAApByC,EAAazC,IAAcA,EAAIN,EAAS,EACxC,IAAK,IAAIkD,EAAI5C,EAAI,EAAG4C,GAAKlD,EAAQkD,IAAK,CAClC,GAAIA,IAAMlD,EACN,MAAO,6BAEX,GAAwB,MAApB+C,EAAaG,GAAY,CACzB5C,EAAI4C,EACJ,MAEJD,GAAiBF,EAAaG,OAE/B,CACH,MAAMC,EAAQJ,EAAazC,GACrB8C,EAAQD,EAAQJ,EAAazC,EAAI,GACjC+C,EAAQD,EAAQL,EAAazC,EAAI,GACnC5B,EAAa,GAAGyB,SAASkD,IACzBJ,GAAiBtE,EAAcC,EAAUyE,EAAOvE,GAChDwB,GAAK,GACE5B,EAAa,GAAGyB,SAASiD,IAChCH,GAAiBtE,EAAcC,EAAUwE,EAAOtE,GAChDwB,GAAK,GACE5B,EAAa,GAAGyB,SAASgD,GAChCF,GAAiBtE,EAAcC,EAAUuE,EAAOrE,GAEhDmE,GAAiBE,EAI7B,OAAOF,GEVIK,CAAe3B,KAAMoB,EAAcjE,GAG9C2C,cAAc8B,GACV,MAA+C,kBAAxCV,OAAOW,UAAUC,SAASC,KAAKH,GAG1C9B,gBAAgB8B,GACZ,MAA2B,iBAAbA,EAAIjE,MAA0C,iBAAdiE,EAAIpE,OAC3B,iBAAZoE,EAAIvE,IAGnByC,qBAAqB8B,GACjB,MAA2B,iBAAbA,EAAIjE,WAAmC8B,IAAdmC,EAAIpE,YAC3BiC,IAAZmC,EAAIvE,KAAkD,iBAAtBuE,EAAII,cAG5ClC,8BAA8BmC,GAC1B,MAAMC,EAAa/B,WAAeC,WAAW,CAAEzC,KAAM,KAAMH,MAAO,EAAGH,IAAK,GAAImD,KAAM,QAC9E2B,EAAahC,WAAeC,WAAW,CAAEzC,KAAM,KAAMH,MAAO,EAAGH,IAAK,GAAImD,KAAM,QACpF,OAAOyB,EAAWC,GAAcD,EAAWE,EAG/CrC,wBACI,GAAIE,KAAKoC,8BAA8BpC,KAAKE,gBACxC,MAAM,IAAImC,WAAW,+DAEzB,MAAMC,EAAgBtC,KAAKE,eAAevC,KACpC4E,EAA0BpC,WAAeC,WAAW,CAAEzC,KAAM,KAAMH,MAAO,EAAGH,IAAK,GAAImD,KAAM,QACjG,GAAIR,KAAKE,eAAiBqC,EAAyB,CAC/C,MAAM/E,MAAEA,EAAKH,IAAEA,GAAQ2C,KAAKE,eACxB1C,EAAQ,GAAgB,IAAVA,GAAeH,EAAM,IACnC2C,KAAKwC,QAAUrC,WAAeC,WAAW,CAAEzC,KAAM2E,EAAgB,EAAG9E,MAAO,EAAGH,IAAK,GAAImD,KAAM,QAC7FR,KAAKa,MAAQyB,EAAgB,OAE7BtC,KAAKwC,QAAUrC,WAAeC,WAAW,CAAEzC,KAAM2E,EAAe9E,MAAO,EAAGH,IAAK,GAAImD,KAAM,QACzFR,KAAKa,MAAQyB,EAAgB,MAEjCtC,KAAKyC,wBACLzC,KAAK0C,mBAAqB,CAAC,GAAI,EAAG,GAAI,QAEtC1C,KAAKa,MAAQyB,EAAgB,KAC7BtC,KAAK2C,kBAAiB,GAE1B3C,KAAK4C,sBAMT9C,sBACI,MAAM+C,EAAgB7C,KAAK8C,WAAW9C,KAAKE,gBACvC2C,EAAgB,KAChB7C,KAAK+C,OAASnF,KAAKC,OAAOgF,EAAgB,GAAK,GAAK,GACpD7C,KAAKgD,MAAQH,EAAgB,GAAK,GAAK,GAChCA,EAAgB,IAAM7C,KAAKiD,iBAClCjD,KAAK+C,OAAS,GACd/C,KAAKgD,KAAOH,EAAgB,MAE5B7C,KAAK+C,OAAS,GACd/C,KAAKgD,KAAOH,GAAiB,IAAM7C,KAAKiD,kBAIhDnD,iBAAiBC,GAEb,GADAC,KAAKa,MAAQd,EAAKpC,KACdqC,KAAKa,MAAQ,GAAKb,KAAKa,MAAQ,IAC/B,MAAM,IAAIwB,WAAW,oDAQzB,GAPWrC,KAAKa,MAAQ,KACpBb,KAAKwC,QAAUrC,WAAeC,WAAW,CAAEzC,KAAM,KAAOqC,KAAKa,MAAOrD,MAAO,EAAGH,IAAK,GAAImD,KAAM,QAC7FR,KAAKyC,wBACLzC,KAAK0C,mBAAqB,CAAC,GAAI,EAAG,GAAI,IAEtC1C,KAAK2C,mBAEL3C,KAAKU,gBAAgBX,GAAO,CAG5B,GAFAC,KAAK+C,OAAShD,EAAKvC,MACnBwC,KAAKgD,KAAOjD,EAAK1C,IACG,KAAhB2C,KAAK+C,QAAiB/C,KAAKgD,KAAOhD,KAAKiD,gBAAiB,CAGxD,GAAIjD,KAAKgD,KAAOhD,KAAKiD,iBAAoB,EAIrC,MAAM,IAAIjE,UAAU,+CAHpBgB,KAAK+C,OAAS,GACd/C,KAAKgD,KAAO,EAKpB,GAAIhD,KAAK+C,OAAS,GAAK/C,KAAK+C,OAAS,IAAM/C,KAAKgD,KAAO,GAAKhD,KAAK3C,IAAM,GACnE,MAAM,IAAI2B,UAAU,mDAErB,CACH,GAAIe,EAAKiC,cAAgB,GAAKjC,EAAKiC,cAAgB,GAC/C,MAAM,IAAIhD,UAAU,mDAExBgB,KAAKkD,SAAWnD,EAAKiC,eACpBhC,KAAK+C,OAAQ/C,KAAKgD,MAAQhD,KAAKmD,kBAAkBnD,KAAKkD,UAE3DlD,KAAKE,eAAiBF,KAAKwC,QAAQY,KAAKC,WAAejD,WACnD,CAAEkD,KAAMtD,KAAK8C,WAAW,CAAC9C,KAAKa,MAAOb,KAAK+C,OAAQ/C,KAAKgD,OAAS,KAGxElD,wBACQK,WAAeC,WAAW,CAAEzC,KAAMqC,KAAKwC,QAAQ7E,KAAO,IAAK4F,aAC3DvD,KAAKiD,gBAAkB,EAEvBjD,KAAKiD,gBAAkB,EAI/BnD,iBAAiB0D,GAA6B,GAC1C,IAAIC,EAAWzD,KAAK0D,uBAChBF,GAAqBxD,KAAKE,eAAiBuD,EAASE,SACpD3D,KAAKa,OAAS,EACd4C,EAAWzD,KAAK0D,wBAEpB1D,KAAKwC,QAAUiB,EAASE,OACxB3D,KAAKiD,gBAAkBQ,EAASG,eAChC5D,KAAK0C,mBAAqBe,EAASI,cAGvC/D,uBACI,IAAI6D,EAAQC,EAAgBC,EAG5B,GAAqB,SAAjBjE,EAAU,GAAe,CACzB,MAAMkE,EAAalE,EAAUI,KAAKa,MAAQ,KAAKpC,MAAM,IACrDkF,EAASxD,WAAeC,WACpB,CAAEzC,KAAMqC,KAAKa,MAAQ,IAAM,KAAMrD,MAAO,EAAGH,IAAK0G,SAASD,EAAW,GAAI,IAAKtD,KAAM,QACvFoD,EAAiBG,SAASD,EAAW,GAAI,IACzC,MAAME,EAAM,CAACD,SAASD,EAAW,GAAI,IAAKC,SAASD,EAAW,GAAI,KAC5DG,EAAMD,EAAI,GAAK,GAAK,CAACA,EAAI,GAAIA,EAAI,GAAK,GAAK,CAACA,EAAI,GAAK,EAAG,GAC9DH,EAAgB,CAACG,EAAI,GAAIA,EAAI,GAAIC,EAAI,GAAIA,EAAI,UAE1CN,OAAAA,EAAQC,eAAAA,EAAgBC,cAAAA,GAAkBjE,EAAUI,KAAKa,QAC5D8C,EAASxD,WAAe+D,QAAQP,EAAQ,CAAEnD,KAAM,QAEpD,MAAO,CAAEmD,OAAAA,EAAQC,eAAAA,EAAgBC,cAAAA,GAGrC/D,WAAWC,GAEP,OAAIoE,MAAMC,QAAQrE,GAEVA,EAAK,GAAK,GACH,IAAMA,EAAK,GAAK,GAAKA,EAAK,GACd,KAAZA,EAAK,GACL,IAAMA,EAAK,GAGf,IAAMC,KAAKiD,gBAAkBlD,EAAK,GAErCA,EAAwBsE,KAAKrE,KAAKwC,SAAS8B,GAAG,QAAU,EAGpExE,YAAYyE,GACRvE,KAAKE,eAAiBC,WAAeqE,QAAQ,0BAC7CxE,KAAKa,MAAQ4D,IACbzE,KAAK+C,OAAS0B,IACdzE,KAAKgD,KAAOyB,IACZzE,KAAKiD,gBAAkBwB,IACvBzE,KAAKwC,QAAUrC,WAAeqE,QAAQ,0BACtCxE,KAAK0E,QAAS,EACd1E,KAAK2E,eAAiBJ,EAG1BzE,cACI,MAAM8E,EAAU5E,KAAKmD,kBACrBnD,KAAKkD,SAAWa,SAAS7C,OAAO2D,KAAKD,GAChCE,KAAKC,GAAOH,EAAQG,GAAK,KAAO/E,KAAK+C,QAAU6B,EAAQG,GAAK,KAAO/E,KAAKgD,MAAO,IAGxFlD,kBACI,MAAO,CACHvE,EAAkB,CAAC,EAAG,GACtBC,EAAuB,CAAC,EAAG,IAC3BC,EAAuB,CAAC,EAAG,GAC3BC,EAAyB,CAAC,EAAG,GAC7BC,EAA+B,CAAC,EAAGqE,KAAKa,MAAQ,IAAM,EAAI,GAC1DjF,EAAgC,CAAC,EAAG,IACpCC,EAA6B,CAAC,EAAGmE,KAAKa,MAAQ,IAAM,GAAK,IACzD/E,EAAyB,CAACkE,KAAK0C,mBAAmB,GAAI1C,KAAK0C,mBAAmB,IAC9E3G,EAA4B,CAACiE,KAAK0C,mBAAmB,GAAI1C,KAAK0C,mBAAmB,IACjF1G,GAA4B,CAAC,GAAI,GACjCC,GAAgC,CAAC,GAAI,IAI7C6D,mBACI,IAAIkF,EAAkBpH,KAAKC,MAAMD,KAAKqH,IAAIjF,KAAKrC,KAAO,EAAG,KAAO,GAWhE,OAVIqC,KAAKrC,KAAO,MAES,SAAjBiC,EAAU,GACVoF,GAAmBpF,EAAU7B,MAAM,EAAGiC,KAAKrC,KAAO,KAAKuH,OAAOC,GAAsB,MAAbA,EAAM,IAAY9G,OAEzF2G,GAAmB9D,OAAOkE,QAAQxF,GAC7BsF,OAAO,EAAEvH,EAAM0H,KAAUtB,SAASpG,EAAM,IAAMqC,KAAKrC,MACf,IAAhC0H,EAAazB,gBAAsBvF,QAG7C2G,EAGXlF,QAAQ3C,GACJ,OAAK6C,KAAKkD,eAGOzD,IAAbtC,QAAmDsC,IAAzB9C,EAAWQ,KACrCA,EAAW,WAERI,EAAmBJ,EAAU,UAAW6C,KAAKkD,WALzC,GAQfpD,UACI,OAAOE,KAAK8C,WAAW,CAAC9C,KAAKrC,KAAMqC,KAAKxC,MAAOwC,KAAK3C,MAAQ2C,KAAKsF,mBAAuC,KAAjBtF,KAAKrC,KAAO,GAGvGmC,OAAOyF,GACH,OAAOvF,KAAKqB,SAAWkE,EAAMlE,SAAWrB,KAAKwF,YAAcD,EAAMC,UAGrEnE,cACI,OAAOrB,KAAK0E,OAGhBH,oBACI,OAAOvE,KAAK2E,eAGhBtH,UACI,OAAO2C,KAAKgD,KAGhBxF,YACI,OAAOwC,KAAK+C,OAGhBpF,WACI,OAAOqC,KAAKa,MAIhBnD,cACI,OAAQsC,KAAKE,eAAexC,QAAU,GAAK,EAAI,EAGnD+H,kBACI,OAAQzF,KAAKa,MAAQ,GAAK,GAAK,EAGnC6E,YACI,OAAQ9H,KAAKC,OAAOmC,KAAKa,MAAQ,GAAK,IAAM,GAAM,EAGtD8E,gBACI,OAAO/H,KAAKC,OAAOmC,KAAKa,MAAQ,GAAK,KAAO,EAIhDpD,oBACI,OAAOuC,KAAKE,eAGhB0D,qBACI,OAAO5D,KAAKiD,gBAGhBjB,oBACI,OAAOhC,KAAKkD,SAAWlD,KAAKkD,cAAWzD,EAG3CmG,oBACI,OAAO5F,KAAKkD,SAAWlD,KAAKgC,cAAgB,QAAKvC,EAGrDoG,gBACI,IAAIlI,KAAEA,EAAIH,MAAEA,GAAUwC,KACtB,OAAQxC,GACJ,KAAK,GACDA,EAAQ,GACR,MACJ,KAAK,GACDA,EAAQ,EACRG,GAAQ,EACR,MACJ,KAAK,GACDH,EAAQ,GACR,MACJ,QACIA,GAAS,EAEjB,OAAO,IAAIqC,EAAS,CAAElC,KAAAA,EAAMH,MAAAA,EAAOH,IAAK,IAG5CyI,oBACI,IAAInI,KAAEA,EAAIH,MAAEA,GAAUwC,KACtB,OAAQxC,GACJ,KAAK,EACDA,EAAQ,GACRG,GAAQ,EACR,MACJ,KAAK,GACDH,EAAQ,GACR,MACJ,KAAK,GACDA,EAAQ,GACR,MACJ,QACIA,GAAS,EAEjB,OAAO,IAAIqC,EAAS,CAAElC,KAAAA,EAAMH,MAAAA,EAAOH,IAAK,IAG5C0I,cACI,OAAkB,KAAd/F,KAAKgD,MAAgC,KAAhBhD,KAAK+C,QAAiB/C,KAAKgD,OAAShD,KAAKiD,gBACvDjD,KAAK6F,UAET,IAAIhG,EAAS,CAAElC,KAAMqC,KAAKa,MAAOrD,MAAOwC,KAAK+C,OAAQ1F,IAAK2C,KAAKgD,KAAO,IAGjFgD,kBACI,GAAkB,IAAdhG,KAAKgD,KAAY,CACjB,MAAM8C,cAAEA,GAAkB9F,KAC1B,IAAI3C,EAAM,GAIV,OAHoB,KAAhB2C,KAAK+C,SACL1F,EAAM2C,KAAKiD,iBAER,IAAIpD,EAAS,CAChBlC,KAAMmI,EAAcnI,KACpBH,MAAOsI,EAActI,MACrBH,IAAAA,IAGR,OAAO,IAAIwC,EAAS,CAAElC,KAAMqC,KAAKa,MAAOrD,MAAOwC,KAAK+C,OAAQ1F,IAAK2C,KAAKgD,KAAO,qCAI3DiD,IH1WC,IAAC9I,EAWA+I,EGgWpBD,EAASE,kBH3WWhJ,EG4WD8I,EAASE,qBH3WH1G,IAAzB9C,EAAWQ,GAEXiJ,QAAQC,IAAI,iEAEZ1J,EAAoB,QAAIA,EAAWQ,IGyWnC8I,EAASnJ,kBHnWWoJ,EGoWDD,EAASnJ,gBHnW5B,CAAC,MAAO,IAAK,YAAa,QAAQ0B,SAAS0H,GAC3CpJ,EAAkBoJ,EAGlBE,QAAQC,IAAI"}